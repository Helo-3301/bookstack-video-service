# Gitleaks configuration for secret scanning
# https://github.com/gitleaks/gitleaks

title = "BSVS Secret Scanning"

[extend]
useDefault = true

# Custom rules for this project
[[rules]]
id = "laravel-app-key"
description = "Laravel APP_KEY"
regex = '''APP_KEY\s*=\s*base64:[A-Za-z0-9+/=]{32,}'''
tags = ["key", "laravel"]

[[rules]]
id = "bookstack-token"
description = "BookStack API Token"
regex = '''(?i)(bookstack[_-]?token|token[_-]?secret)\s*[=:]\s*[A-Za-z0-9]{20,}'''
tags = ["token", "bookstack"]

# Allowlist for false positives
[allowlist]
description = "Allowlisted patterns"
paths = [
    '''\.env\.example$''',
    '''\.md$''',
]
regexes = [
    '''CHANGE_ME''',
    '''GENERATE_ME''',
    '''REMOVED_FROM_HISTORY''',
    '''dev-only-change-in-production''',
]
